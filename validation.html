<!DOCTYPE html>
<html>
<head>
    <title>Validation de Code</title>
    <script>
        // Récupération du code dans l'URL
        const params = new URLSearchParams(window.location.search);
        const userCode = params.get("code");
        
        // Vérification du code via Google Apps Script
        async function validateCode() {
            const response = await fetch(`https://script.google.com/macros/s/AKfycbyfQle2euG8qNWv3tY2fBpPjfjKg3t2WhssE8Op9QevX3nEiRHOL5iJ1iKktbTl9QLy/exec?code=${userCode}`);
            const result = await response.json();
            
            if (result.status === 'success') {
                // Redirection vers la 2ème enquête
                window.location.href = result.url;
            } else {
                // Affiche le message d'erreur correspondant
                document.getElementById('message').innerText = result.message;
            }
        }
        
        // Lance la vérification dès le chargement de la page
        window.onload = validateCode;
    </script>
</head>
<body>
    <h1 id="message">Vérification en cours...</h1>
</body>
</html>
